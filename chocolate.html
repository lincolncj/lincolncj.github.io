<html lang="en"><head>
  <meta charset="UTF-8">
  <title>Brian's Chocolate Dilemma</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --denim:#8B4513;
      --denim-mid:#A0522D;
      --denim-light:#CD853F;
      --stitch:#f6e27a;
      --btn:#8B4513;
      --btn-hover:#654321;
      --ink:#111;
    }
    *{box-sizing:border-box}
    html,body{
      height:100%;
      margin:0;
    }
    body{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:flex-start;
      gap:22px;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Emoji, Noto Color Emoji, Arial, sans-serif;
      background:#f7f8fb;
      color:#222;
      padding:28px 12px 40px;
      overflow-x:hidden;
    }
    h1{
      margin:0;
      font-size: clamp(1.2rem, 1rem + 2vw, 2rem);
      text-align:center;
    }

    .pocket-scene{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
      width: min(92vw, 520px);
    }

    .pocket-wrap{
      position:relative;
      width: min(90vw, 360px);
      height: min(60vw, 260px);
      max-width: 420px;
      max-height: 300px;
      margin-inline:auto;
      perspective: 800px;
      user-select:none;
      /* Add a little extra space below so buttons don't sit under the pocket */
      margin-bottom: clamp(20px, 6vw, 48px);
    }

    /* Denim pocket base (SVG) */
    .pocket-base{
      position:absolute;
      inset:0;
      z-index:1;
    }
    /* Top lip to hide the chocolate as it pops out */
    .lip{
      position:absolute;
      left:6%;
      right:6%;
      top:8px;
      height:28px;
      background: linear-gradient(#A0522D, #8B4513);
      border-bottom: 3px solid #654321;
      border-radius: 4px 4px 10px 10px;
      z-index: 5;
      box-shadow: 0 6px 12px rgba(0,0,0,0.15) inset;
    }
    .lip:after{
      content:"";
      position:absolute;
      left:10px; right:10px; top:14px;
      height:0;
      border-bottom:2px dashed var(--stitch);
      opacity:.9;
    }

    /* The chocolate in the pocket */
    .mouse{
      position:absolute;
      left:50%;
      bottom:12px;
      transform: translate(-50%, 80%) scale(1);
      transform-origin: 50% 100%;
      z-index:3; /* between base and lip initially */
      text-align:center;
      transition: transform .9s cubic-bezier(.2,.8,.2,1);
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.25));
    }
    .mouse .face{
      font-size: clamp(64px, 12vw, 90px);
      line-height: 1;
    }
    .mouse .tiny{
      display:block;
      font-size: .9rem;
      margin-top: 2px;
      opacity:.7;
    }

    /* Speech bubble */
    .speech{
      position:absolute;
      left: 55%;
      top: 12%;
      transform: translateX(-50%) scale(.9);
      background:#fff;
      color:var(--ink);
      border:2px solid #00000018;
      border-radius:14px;
      padding:10px 14px;
      font-weight:600;
      box-shadow: 0 8px 18px rgba(0,0,0,.12);
      opacity:0;
      pointer-events:none;
      z-index:6;
    }
    .speech:after{
      content:"";
      position:absolute;
      left:18px;
      bottom:-10px;
      border:10px solid transparent;
      border-top-color:#fff;
      filter: drop-shadow(0 2px 0 #00000018);
    }

    /* Active state: chocolate pops up with a wiggle */
    .pocket-wrap.active .mouse{
      transform: translate(-50%, -8%) scale(1.05);
      animation: wiggle 1.1s ease-in-out .75s 2;
    }
    .pocket-wrap.active .speech{
      animation: popIn .45s ease-out .55s forwards, bob 1.4s ease-in-out 1s 2;
    }

    @keyframes wiggle{
      0%{ transform: translate(-50%,-8%) rotate(0) scale(1.05);}
      25%{ transform: translate(-50%,-10%) rotate(-6deg) scale(1.06);}
      50%{ transform: translate(-50%,-12%) rotate(6deg) scale(1.06);}
      100%{ transform: translate(-50%,-8%) rotate(0) scale(1.05);}
    }
    @keyframes popIn{
      from{ opacity:0; transform: translateX(-50%) translateY(6px) scale(.9);}
      to{   opacity:1; transform: translateX(-50%) translateY(0)   scale(1);}
    }
    @keyframes bob{
      0%,100%{ transform: translateX(-50%) translateY(0) scale(1);}
      50%{    transform: translateX(-50%) translateY(-6px) scale(1);}
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      /* Move buttons further down so they don't get covered by the pocket */
      margin-top: clamp(12px, 4vw, 32px);
    }
    button{
      background: var(--btn);
      color:#fff;
      border:none;
      border-radius: 10px;
      padding: 12px 18px;
      font-size: 1rem;
      cursor:pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,.12);
      transition: transform .06s ease, background .2s ease, box-shadow .2s ease, opacity .2s;
    }
    button:hover{ background: var(--btn-hover); }
    button:active{ transform: translateY(1px); }
    button:disabled{
      opacity:.6;
      cursor:not-allowed;
    }

    /* Chocolate confetti */
    .cheese{
      position: fixed;
      top:-40px;
      font-size: 24px;
      z-index: 9998;
      animation: fall linear forwards;
      pointer-events:none;
      will-change: transform, opacity;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,.25));
    }
    @keyframes fall{
      0%{ transform: translateY(-40px) rotate(0deg); opacity:1; }
      100%{ transform: translateY(110vh) rotate(720deg); opacity:.95; }
    }

    /* Fullscreen Brian reveal */
    #fullscreenMouse{
      position: fixed;
      inset: 0;
      background: #000;
      display: grid;
      place-items: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity .6s ease;
      z-index: 9999;
    }
    #fullscreenMouse.show{
      opacity: 1;
      pointer-events: auto;
    }
    #fullscreenMouse .inner{
      position: relative;
      width: 100vw;
      height: 100vh;
      overflow:hidden;
    }
    #fullscreenMouse video{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: contain;
      background:#111;
      animation: fadein 1s ease;
      user-select:none;
    }
    #fullscreenMouse img{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit: contain;
      background:#111;
      animation: fadein 1s ease;
      user-select:none;
    }
    #fullscreenMouse .caption{
      position:absolute;
      left:50%;
      bottom: clamp(14px, 6vh, 36px);
      transform: translateX(-50%);
      color:#fff;
      font-weight:800;
      text-shadow: 0 2px 8px rgba(0,0,0,.6);
      font-size: clamp(18px, 4vw, 36px);
      background: rgba(0,0,0,.35);
      padding: 8px 14px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.2);
      backdrop-filter: blur(2px);
    }
    @keyframes fadein{ from{opacity:0} to{opacity:1} }

    .hint{
      font-size:.9rem;
      opacity:.7;
      text-align:center;
      margin-top:-6px;
    }
  </style>
</head>
<body>
  <h1>Brian's Chocolate Dilemma</h1>

  <div class="pocket-scene">
    <div class="pocket-wrap" id="pocket">
      <!-- Pocket base (chocolate colored + stitching) -->
      <svg class="pocket-base" viewBox="0 0 300 260" aria-hidden="true">
        <!-- Chocolate gradient -->
        <defs>
          <linearGradient id="chocolate" x1="0" x2="0" y1="0" y2="1">
            <stop offset="0%" stop-color="#A0522D"></stop>
            <stop offset="100%" stop-color="#8B4513"></stop>
          </linearGradient>
        </defs>
        <!-- U-shaped pocket panel -->
        <path d="M18,20 L282,20 L262,232 Q150,256 38,232 Z" fill="url(#chocolate)" stroke="#654321" stroke-width="6"></path>
        <!-- Stitching along the edge -->
        <path d="M28,28 L272,28 L255,226 Q150,246 45,226 Z" fill="none" stroke="var(--stitch)" stroke-width="3" stroke-dasharray="8 6" opacity=".9"></path>
        <!-- Subtle highlight -->
        <path d="M28,40 L272,40" stroke="rgba(255,255,255,.25)" stroke-width="2"></path>
      </svg>

      <!-- The pocket chocolate -->
      <div class="mouse" id="mouse">
        <div class="face" aria-hidden="true">üç´</div>
        <span class="tiny" aria-hidden="true">definitely chocolate</span>
      </div>

      <!-- Top lip (covers the chocolate as it pops out) -->
      <div class="lip"></div>

      <!-- Speech bubble -->
      <div class="speech" id="speech" aria-live="polite" style="opacity: 0;">I love chocolate!</div>
    </div>

    <div class="controls">
      <button id="checkBtn">Check for chocolate</button>
      <button id="feedBtn" title="Drop some chocolate">More chocolate üç´</button>
      <button onclick="window.location.href='index.html'">Back to Mouse üê≠</button>
    </div>
    <div class="hint">Tip: Click the big reveal to go back.</div>
  </div>

  <!-- Fullscreen Brian reveal -->
  <div id="fullscreenMouse" role="dialog" aria-label="Fullscreen Brian Griffin chocolate dilemma" class="">
    <div class="inner">
      <video autoplay muted loop id="brianVideo" style="display:none;">
        <source src="https://s3.amazonaws.com/v.comb.io/MLNENt5P/9SFSso.mp4" type="video/mp4">
      </video>
      <img src="https://i.imgflip.com/1wz8zf.jpg" alt="Brian Griffin saying I love chocolate but I can't eat it cause I'll get fat" id="fallbackImage">
      <div class="caption">I love chocolate, but I can't eat it cause I'll get fat! üç´</div>
    </div>
  </div>

  <script>
    const pocket = document.getElementById('pocket');
    const speech = document.getElementById('speech');
    const checkBtn = document.getElementById('checkBtn');
    const feedBtn = document.getElementById('feedBtn');
    const fullscreen = document.getElementById('fullscreenMouse');

    const lines = [
      "I love chocolate!",
      "But I can't eat it...",
      "Cause I'll get fat!",
      "This is my dilemma.",
      "Why is life so cruel?"
    ];

    function sayRandom(){
      const line = lines[Math.floor(Math.random()*lines.length)];
      speech.textContent = line;
    }

    function dropChocolate(count = 22){
      for(let i=0;i<count;i++){
        const s = document.createElement('span');
        s.className = 'cheese';
        s.textContent = 'üç´';
        const duration = 2600 + Math.random()*2200;
        const size = 18 + Math.random()*20;
        const startX = Math.random()*100;
        const delay = Math.random()*400;

        s.style.left = startX + 'vw';
        s.style.fontSize = size + 'px';
        s.style.animationDuration = duration + 'ms';
        s.style.animationDelay = delay + 'ms';
        document.body.appendChild(s);
        setTimeout(()=> s.remove(), duration + delay + 150);
      }
    }

    checkBtn.addEventListener('click', () => {
      // Pop the chocolate
      pocket.classList.add('active');
      checkBtn.disabled = true;

      // Chat a bit
      sayRandom();

      // Chocolate confetti for comedic effect
      dropChocolate(28);

      // Dramatic "full screen Brian" reveal with video
      setTimeout(()=> {
        fullscreen.classList.add('show');
        
        // Try to play the video, fallback to image
        const video = document.getElementById('brianVideo');
        const image = document.getElementById('fallbackImage');
        
        video.style.display = 'block';
        image.style.display = 'none';
        
        video.play().catch(() => {
          // If video fails, show image instead
          video.style.display = 'none';
          image.style.display = 'block';
        });
      }, 1200);
    });

    feedBtn.addEventListener('click', () => {
      dropChocolate(18);
      // Make Brian express his dilemma if visible
      if(pocket.classList.contains('active')){
        speech.textContent = "But I can't eat it cause I'll get fat!";
        speech.style.opacity = 1;
      }
    });

    // Click anywhere on the fullscreen to close and reset
    fullscreen.addEventListener('click', () => {
      fullscreen.classList.remove('show');
      
      // Stop video
      const video = document.getElementById('brianVideo');
      video.pause();
      video.currentTime = 0;
      
      // Reset after a moment
      setTimeout(()=>{
        pocket.classList.remove('active');
        checkBtn.disabled = false;
        speech.style.opacity = 0;
      }, 400);
    });

    // Make the speech bubble fade back out after a while
    const observer = new MutationObserver(() => {
      speech.style.opacity = 1;
      clearTimeout(speech._hideTimer);
      speech._hideTimer = setTimeout(()=> speech.style.opacity = 0, 2500);
    });
    observer.observe(speech, { childList:true });
  </script>

</body></html>
